<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
  <!-- I recommend you host this file on your own, since this will change without warning -->
  <script src="https://datamaps.github.io/scripts/datamaps.world.min.js?v=1"></script>
  <title>Bodegas of the World</title>
  <h1> Bodegas of the World</h1>
  <div class="siteBox">
  <div id="bodegaDiv">
    <h1> Test!</h1> 
    <p id="testPara">
      Whoop whoop whoop whoop whoop whoop whoop whoop whoop whoop
    </p>
       </div>
  <div id="mapBox">
  <div id="worldMap" style="position: relative; width: 600px; height: 450px;"></div>
  </div>
  </div>
  <!-- Add as many pattern definitions (defs) as you'd like, make sure to include an ID -->
<svg xmlns="http://www.w3.org/2000/svg" version="1.1"
     xmlns:xlink="http://www.w3.org/1999/xlink">

       
    <!-- Horizontal Stripe pattern -->
    <defs>
        <pattern id="horizontal-stripe"
                 width="4" height="4"
                 patternunits="userSpaceOnUse">
             <line x1="0" y1="2" x2="4" y2="2" stroke="blue" />
        </pattern>
    </defs>
       
       
      <!-- Vertical Stripe pattern -->   
    <defs>
        <pattern id="vertical-stripe"
                 width="4" height="4"
                 patternunits="userSpaceOnUse">
             <line x1="2" y1="0" x2="2" y2="4" stroke="green" />
        </pattern>
    </defs>
    
     <!-- Diagonal Stripe pattern -->
    <defs>
        <pattern id="diagonal-stripe"
                 patterntransform="rotate(45)"
                 width="4" height="4"
                 patternunits="userSpaceOnUse">
             <line x1="2" y1="0" x2="2" y2="4" stroke="#bada55" stroke-width="2" />
        </pattern>
    </defs>

      <!-- Circles pattern --> 
    <defs>
        <pattern id="circles"
                 width="4" height="4"
                 patternunits="userSpaceOnUse">
                   <circle cx="2.5" cy="2.5" r="1.3" fill="green" />
      </pattern>
    </defs>
      
       <!-- Gradient pattern. Wouldn't really recommend this one. -->
     <lineargradient id="gradient">
        <stop offset="5%" stop-color="#F60" />
        <stop offset="95%" stop-color="#FF6" />
     </lineargradient>
       
     <!-- Triangles pattern -->  
     <pattern id="triangle"
       width="8" height="8"
       patternunits="userSpaceOnUse">
         <polygon points="3,0 6,6 0,6" fill="purple"/>
      </pattern>
</svg>
     
     <script>
      //var aitoff = d3.geoAitoff();
      var elem = document.querySelector('#testPara');
       
      var election = new Datamap({
        scope: 'world',
        element: document.getElementById('worldMap'),
        projection: 'mercator',
        
        fills: {
          //defaultFill: '#f0af0a',
          defaultFill: 'url(#horizontal-stripe)',
          horizontalStripe: 'url(#horizontal-stripe)',
          diagonalStripe: 'url(#diagonal-stripe)',
          verticalStripe: 'url(#vertical-stripe)',
          circles: 'url(#circles)',
          gradient: 'url(#gradient)',
          triangle: 'url(#triangle)'
        },
        
            // dataUrl: 'country_data.csv',
            // dataType: 'csv', //using a CSV is not working properly.
        data: {
          USA: {fillKey: 'gradient',
                bodegaStatus: 'Observed',
                bodegaImage: 'https://cdn.glitch.com/23fa8cec-e81a-4213-bfab-85d4d2ae92d0%2FScreen%20Shot%202018-09-13%20at%2012.23.12%20AM.png?1543907460423'},
          CAN: {fillKey: 'gradient',
                bodegaStatus: 'Observed' },
          MEX: {fillKey: 'gradient',
                bodegaStatus: 'Observed'},
          MAR: {fillKey: 'gradient',
                bodegaStatus: 'Observed'},
          DEU: {fillKey: 'gradient',
                bodegaStatus: 'Observed'},
          ESP: {fillKey: 'gradient',
                bodegaStatus: 'Observed'}
          // RUS: {fillKey: 'verticalStripe' },
          // BRA: {fillKey: 'circles' },
          // GRL: {fillKey: 'gradient'},
          // CHN: {fillKey: 'triangle' }
          
        },
         geographyConfig: {
         hideAntarctica: false,
         popupTemplate: function(geo, data) {
                if(!data){
                        return ['<div class="hoverinfo"><strong>',
                        //The status is not working, it's making the name thing null for all of them that don't have a status. 
                        geo.properties.name, ' ', '</strong><br>' + 'Not yet observed.' +
                        '</div>'].join('');
                } else {
                return ['<div class="hoverinfo"><strong>',
                        //The status is not working, it's making the name thing null for all of them that don't have a status. 
                        geo.properties.name + ' ' + '</strong><br>' + data.bodegaStatus, 
                        '</div>'].join('');
                }
      }
      },
        //The below is definitely the right direction but it only sort of works. 
        done: function(datamap) {
        var html = elem.innerHTML;
        datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {
          var countryName = datamap.options.data
          if(!data) {
            elem.innerHTML = 'Return to whoop whoop whoop. No bodegas.'
          } else {
            elem.innerHTML = countryName

          }
          //console.log('WOO!');
          //var html = elem.innerHTML;

            // Set HTML content
            //elem.innerHTML = 'We can dynamically change the HTML. We can even include HTML elements like <a href="#">this link</a>.'
            // var state_id = geography.id;
            // var fillkey_obj = datamap.options.data[state_id] || {fillKey: 'defaultFill'};
            // var fillkey = fillkey_obj.fillKey;;
            // var fillkeys = Object.keys(fills);
            // var antikey = fillkeys[Math.abs(fillkeys.indexOf(fillkey) - 1)];
            // var new_fills = {
            //   [geography.id] : {
            //     fillKey: antikey
            //   }
            // };
            // datamap.updateChoropleth(new_fills);
        })}
});

           </script>
</body>

 <!-- All Credit to: https://web.archive.org/web/20150625160038/http://datamaps.markmarkoh.com/custom-fill-patterns-for-datamaps/  -->
<!-- Put the images in the left of the map, or top of the map on mobile. Organize code to map it easy to make this the X of the world. -->
<!-- color fill should then depend on whether there is an asset with that given name. -->